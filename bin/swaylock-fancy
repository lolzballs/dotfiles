#!/bin/bash

if pidof -x swaylock >/dev/null; then
    exit 0
fi

RESOLUTION=`xdpyinfo | awk '/dimensions/{print $2}'`

trap reset SIGHUP SIGINT SIGTERM

grim /tmp/screenshot.png
ffmpeg -loglevel quiet -y -i /tmp/screenshot.png -vf 'gblur=sigma=8' /tmp/screenshotblur.png
rm /tmp/screenshot.png

swaylock -i /tmp/screenshotblur.png
rm /tmp/screenshotblur.png

reset

